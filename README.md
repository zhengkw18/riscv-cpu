# riscv-cpu

使用verilog实现五级流水线riscv cpu，支持异常、页表、分支预测、vga和60M高频。被队友carry了，我没听课所以开始流水线完全不会，讨论了两次+写了一些代码才理解了一些。烧脑的sram、串口时序和页表TLB都交给队友了，我写了剩下比较简单的分支预测、数据旁路等，异常用了很tricky的实现方法。能提频到60M也是队友的功劳，这个频率+分支预测能达到的性能应该是前5了吧（我们没有实现BaseRAM和ExtRAM分离，另外超不过的应该是实现了L/D缓存的，据说有一组达到了80M）。

考试前有一个周末进行预习，试题我认为是很好的一套试卷，选择填空既考到了基础又考到了ppt上的一些细节，我速成的还行。大题第一道是解释B/J指令里面立即数的位置为何乱序，群里好像讨论过但我没看，随便解释了一下应该大差不差。第二道是加减交替，第三道是Cache/TLB，复习过作业题所以还算熟练。第四道是没见过的五级流水线设计，我感觉有些怪异，有点理解不了题面，其实应该是我想错了固定1周期SRAM的行为，也搞混了load-store和load-use，考试后和同学讨论才明白了一些，但除去这个还是有一些怪异的地方，比如把分支预测放在ID阶段，并不容易全部考虑对。我几乎没有一问是会的，但都照着普通的五级流水线发挥了一下，期望给一点过程分。最后是一道磁盘题，又是不走寻常路，要自己算读写速度，开始还和助教确认了一番是不是缺条件，之后只得按最合理的算法勉强算了一下。下来和同学对答案，意外的是除了流水线基本一样。能得A也是我没想到的，毕竟流水线大题有整整20分，看来给分很仁慈，也庆幸写了流水线cpu，如果写的是多周期，加上没听课，或许一分也拿不到吧。
